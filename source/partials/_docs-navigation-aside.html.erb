<%
json_data = File.read("source/documentation/navigation.json")
sections = JSON.parse(json_data)
folder_match = lesli_current_page(current_page).match(/\/([^\/]+)\//)
folder = folder_match&.[](1)
%>

<nav>
    <% sections.each do |section, files| %>
        <ul class="<%= "documentation-navigation-active" if section == folder  %>">
            <li>
                <a href="/documentation/<%= section %>">
                    <span class="icon-text is-flex">
                        <span class="is-flex-grow-1"><%= section.gsub("-", " ") %></span>
                        <span class="icon">
                            <% if section == folder %>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.9997 13.1714L16.9495 8.22168L18.3637 9.63589L11.9997 15.9999L5.63574 9.63589L7.04996 8.22168L11.9997 13.1714Z"></path></svg>
                            <% end %>

                            <% if section != folder %>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.1714 12.0007L8.22168 7.05093L9.63589 5.63672L15.9999 12.0007L9.63589 18.3646L8.22168 16.9504L13.1714 12.0007Z"></path></svg>
                            <% end %>
                        </span>
                    </span>
                </a>
            </li>
            <% files.each do |file| %>
                <% next if section != folder %>
                <li>
                    <a 
                        class="<%= "has-text-primary" if "documentation/#{ file['path'] }" == lesli_current_page(current_page) %>"
                        href="/documentation/<%= file["path"] %>">
                        <%= file["label"] %>
                    </a>
                </li>
            <% end %>
        </ul>
        <hr>
    <% end %>
</nav>
